{
  "name": "messaging-teams",
  "version": "0.4.9",
  "description": "Provider-core Microsoft Teams messaging pack (Graph send).",
  "kind": "application",
  "publisher": "Greentic",
  "config_schema": {
    "provider_config": {
      "format": "json",
      "path": "schemas/messaging/teams/config.schema.json"
    }
  },
  "components": [
    "messaging-provider-teams"
  ],
  "extensions": {
    "greentic.provider-extension.v1": {
      "kind": "greentic.provider-extension.v1",
      "version": "0.4.9",
      "inline": {
        "providers": [
          {
            "kind": "messaging",
            "provider_type": "messaging.teams.graph",
            "capabilities": [
              "messaging"
            ],
            "ops": [
              "send",
              "reply"
            ],
            "config_schema_ref": "schemas/messaging/teams/config.schema.json",
            "state_schema_ref": "",
            "runtime": {
              "component_ref": "messaging-provider-teams",
              "export": "schema-core-api",
              "world": "greentic:provider/schema-core@1.0.0"
            },
            "docs_ref": ""
          }
        ]
      }
    },
    "messaging.provider_flow_hints": {
      "kind": "messaging.provider_flow_hints",
      "version": "0.4.9",
      "inline": {
        "messaging.teams.graph": {
          "setup_default": "setup_default",
          "setup_custom": "setup_custom",
          "diagnostics": "diagnostics",
          "verify_webhooks": "verify_webhooks"
        }
      }
    }
  },
  "secret_requirements": [
    {
      "name": "MS_GRAPH_CLIENT_SECRET",
      "scope": "tenant",
      "description": "Client secret used for client_credentials or refresh flows."
    },
    {
      "name": "MS_GRAPH_REFRESH_TOKEN",
      "scope": "tenant",
      "description": "Refresh token used when auth_mode selects refresh_token grant."
    }
  ],
  "flows": [
    {
      "id": "setup_default",
      "kind": "job",
      "version": "0.4.9",
      "file": "flows/setup_default.ygtc",
      "tags": [
        "default"
      ],
      "entrypoints": [
        "setup"
      ]
    },
    {
      "id": "setup_custom",
      "kind": "job",
      "version": "0.4.9",
      "file": "flows/setup_custom.ygtc",
      "tags": [
        "default"
      ],
      "entrypoints": [
        "setup"
      ]
    },
    {
      "id": "diagnostics",
      "kind": "job",
      "version": "0.4.9",
      "file": "flows/diagnostics.ygtc",
      "tags": [
        "default"
      ],
      "entrypoints": [
        "diagnostics"
      ]
    },
    {
      "id": "verify_webhooks",
      "kind": "job",
      "version": "0.4.9",
      "file": "flows/verify_webhooks.ygtc",
      "tags": [
        "maintenance"
      ],
      "entrypoints": [
        "diagnostics"
      ]
    }
  ]
}
